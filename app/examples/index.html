<!DOCTYPE html>
<html lang="en" class="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Near Orbit | Agent Control</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        background: '#09090b', // Zinc 950
                        surface: '#18181b',    // Zinc 900
                        surfaceHighlight: '#27272a', // Zinc 800
                        border: '#27272a',     // Zinc 800
                        accent: '#2dd4bf',     // Teal 400
                        accentDim: 'rgba(45, 212, 191, 0.1)',
                        terminal: '#0d0d0f',
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['ui-monospace', 'SFMono-Regular', 'Menlo', 'monospace'],
                    },
                    animation: {
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    }
                }
            }
        }
    </script>
    <style>
        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: #09090b;
        }

        ::-webkit-scrollbar-thumb {
            background: #27272a;
            border-radius: 3px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #3f3f46;
        }

        .terminal-text {
            font-family: 'Menlo', 'Monaco', 'Courier New', monospace;
            font-size: 0.85rem;
            line-height: 1.5;
        }

        .typing-cursor::after {
            content: '▋';
            animation: blink 1s step-end infinite;
            color: #2dd4bf;
        }

        @keyframes blink {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0;
            }
        }

        /* View Switching */
        .view-section {
            display: none;
        }

        .view-section.active {
            display: flex;
        }
    </style>
</head>

<body class="bg-background text-zinc-300 font-sans antialiased h-screen flex overflow-hidden">

    <!-- SIDEBAR NAVIGATION -->
    <aside
        class="w-20 lg:w-64 border-r border-border bg-surface flex flex-col justify-between z-20 flex-shrink-0 transition-all">
        <div>
            <!-- Branding -->
            <div class="h-16 flex items-center justify-center lg:justify-start lg:px-6 border-b border-border/50">
                <svg width="28" height="28" viewBox="0 0 100 100" fill="none" class="text-accent shrink-0">
                    <path d="M50 20 L85 40 L85 75 L50 95 L15 75 L15 40 Z" stroke="currentColor" stroke-width="8" />
                </svg>
                <span class="ml-3 font-bold text-white tracking-tight hidden lg:block">Near Orbit</span>
            </div>

            <!-- Menu -->
            <nav class="p-4 space-y-2">
                <button onclick="switchView('dashboard')" id="nav-dashboard"
                    class="w-full flex items-center justify-center lg:justify-start gap-3 px-3 py-3 rounded-xl bg-surfaceHighlight text-accent transition-all group relative nav-btn">
                    <i data-lucide="layout-grid" class="w-5 h-5"></i>
                    <span class="hidden lg:block font-medium">Missions</span>
                    <!-- Active Indicator -->
                    <div class="absolute left-0 top-1/2 -translate-y-1/2 w-1 h-8 bg-accent rounded-r-full hidden"></div>
                </button>
                <button onclick="switchView('settings')" id="nav-settings"
                    class="w-full flex items-center justify-center lg:justify-start gap-3 px-3 py-3 rounded-xl text-zinc-500 hover:text-white hover:bg-surfaceHighlight/50 transition-all nav-btn">
                    <i data-lucide="settings-2" class="w-5 h-5"></i>
                    <span class="hidden lg:block font-medium">Settings</span>
                </button>
            </nav>
        </div>

        <!-- User / Server Status -->
        <div class="p-4 border-t border-border">
            <div class="flex items-center gap-3 justify-center lg:justify-start">
                <div class="relative">
                    <div
                        class="w-8 h-8 rounded-full bg-zinc-800 flex items-center justify-center text-xs font-mono border border-zinc-700">
                        SRV</div>
                    <div class="absolute -bottom-1 -right-1 w-3 h-3 bg-green-500 border-2 border-surface rounded-full">
                    </div>
                </div>
                <div class="hidden lg:block overflow-hidden">
                    <div class="text-sm text-white font-medium truncate">Home Server</div>
                    <div class="text-xs text-zinc-500 truncate">Cpu: 12% • Mem: 4GB</div>
                </div>
            </div>
        </div>
    </aside>

    <!-- MAIN CONTENT AREA -->
    <main class="flex-1 flex flex-col relative overflow-hidden bg-background">

        <!-- HEADER (Shared) -->
        <header
            class="h-16 border-b border-border flex items-center justify-between px-6 bg-background/80 backdrop-blur z-10 shrink-0">
            <h2 id="page-title" class="text-lg font-medium text-white">Active Missions</h2>
            <div class="flex items-center gap-4">
                <button
                    class="flex items-center gap-2 px-3 py-1.5 bg-accent text-zinc-900 rounded-lg text-sm font-semibold hover:bg-teal-300 transition-colors">
                    <i data-lucide="plus" class="w-4 h-4"></i>
                    <span class="hidden sm:inline">New Mission</span>
                </button>
            </div>
        </header>

        <!-- ============================================
             VIEW 1: DASHBOARD (SESSION SELECTION)
        ============================================= -->
        <div id="view-dashboard" class="view-section active flex-1 overflow-y-auto p-6">
            <div class="max-w-5xl mx-auto w-full">

                <!-- Active Section -->
                <h3 class="text-xs font-mono text-zinc-500 uppercase tracking-widest mb-4">Running Now</h3>
                <div class="grid md:grid-cols-2 gap-4 mb-8">

                    <!-- Active Card 1 -->
                    <div onclick="switchView('chat')"
                        class="group p-5 bg-surface border border-border rounded-xl hover:border-accent/50 cursor-pointer transition-all relative overflow-hidden">
                        <div class="absolute top-0 right-0 p-4 opacity-50 group-hover:opacity-100 transition-opacity">
                            <i data-lucide="chevron-right" class="w-5 h-5 text-zinc-500 group-hover:text-accent"></i>
                        </div>
                        <div class="flex items-center gap-3 mb-3">
                            <div class="w-2 h-2 rounded-full bg-accent animate-pulse"></div>
                            <span class="text-accent text-xs font-bold tracking-wide">ACTIVE</span>
                            <span class="text-zinc-500 text-xs font-mono">ID: 8aF92</span>
                        </div>
                        <h3 class="text-lg font-medium text-white mb-1">Refactor Auth Middleware</h3>
                        <p class="text-sm text-zinc-400 mb-4 line-clamp-1">Migrating from JWT to PASETO implementation
                            in the rust-backend repo.</p>

                        <!-- Terminal Preview -->
                        <div class="bg-terminal rounded-lg p-3 font-mono text-xs text-zinc-400 border border-border/50">
                            <div class="flex justify-between mb-1 text-zinc-600">
                                <span>Terminal Output</span>
                                <span>2s ago</span>
                            </div>
                            <div class="text-zinc-300">$ cargo check</div>
                            <div class="text-green-400">Compiling auth-service v0.1.0...</div>
                            <div class="opacity-50">Checking dependencies...</div>
                        </div>
                    </div>

                    <!-- Active Card 2 -->
                    <div
                        class="group p-5 bg-surface border border-border rounded-xl hover:border-zinc-600 cursor-pointer transition-all relative">
                        <div class="flex items-center gap-3 mb-3">
                            <div class="w-2 h-2 rounded-full bg-yellow-500"></div>
                            <span class="text-yellow-500 text-xs font-bold tracking-wide">PAUSED</span>
                            <span class="text-zinc-500 text-xs font-mono">ID: 3bC11</span>
                        </div>
                        <h3 class="text-lg font-medium text-white mb-1">Update Documentation</h3>
                        <p class="text-sm text-zinc-400 mb-4">Scanning all endpoints and regenerating OpenAPI specs.</p>
                        <div class="text-xs text-zinc-500 flex items-center gap-2">
                            <i data-lucide="clock" class="w-3 h-3"></i> Waiting for user input
                        </div>
                    </div>
                </div>

                <!-- Past Section -->
                <h3 class="text-xs font-mono text-zinc-500 uppercase tracking-widest mb-4">Recent History</h3>
                <div class="bg-surface border border-border rounded-xl overflow-hidden">
                    <div class="divide-y divide-border">
                        <div
                            class="p-4 flex items-center justify-between hover:bg-surfaceHighlight/50 cursor-pointer transition-colors">
                            <div class="flex items-center gap-4">
                                <div class="p-2 bg-zinc-800 rounded-lg text-zinc-400"><i data-lucide="check-circle"
                                        class="w-4 h-4"></i></div>
                                <div>
                                    <div class="text-sm text-white font-medium">Fix CSS Grid Bug</div>
                                    <div class="text-xs text-zinc-500">Completed 2 hours ago</div>
                                </div>
                            </div>
                            <div class="text-xs text-zinc-500 font-mono">14m duration</div>
                        </div>
                        <div
                            class="p-4 flex items-center justify-between hover:bg-surfaceHighlight/50 cursor-pointer transition-colors">
                            <div class="flex items-center gap-4">
                                <div class="p-2 bg-zinc-800 rounded-lg text-red-400"><i data-lucide="x-circle"
                                        class="w-4 h-4"></i></div>
                                <div>
                                    <div class="text-sm text-white font-medium">Deploy to Staging</div>
                                    <div class="text-xs text-zinc-500">Failed • Network Timeout</div>
                                </div>
                            </div>
                            <div class="text-xs text-zinc-500 font-mono">2m duration</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ============================================
             VIEW 2: CHAT INTERFACE
        ============================================= -->
        <div id="view-chat" class="view-section flex-col flex-1 h-full bg-background">

            <!-- Breadcrumb Navigation (Mobile/Desktop) -->
            <div class="h-10 bg-surfaceHighlight/30 border-b border-border flex items-center px-4 gap-2 text-xs">
                <button onclick="switchView('dashboard')"
                    class="text-zinc-400 hover:text-white flex items-center gap-1">
                    <i data-lucide="arrow-left" class="w-3 h-3"></i> Back
                </button>
                <span class="text-zinc-600">/</span>
                <span class="text-accent">Refactor Auth Middleware</span>
                <span class="ml-auto flex items-center gap-2 text-zinc-500">
                    <span class="w-1.5 h-1.5 rounded-full bg-green-500 animate-pulse"></span> Running
                </span>
            </div>

            <!-- Chat Scroll Area -->
            <div id="chat-scroll" class="flex-1 overflow-y-auto p-4 md:p-6 space-y-6">

                <!-- Message: User -->
                <div class="flex gap-4 max-w-4xl mx-auto">
                    <div
                        class="w-8 h-8 rounded-full bg-zinc-800 border border-zinc-700 flex items-center justify-center shrink-0">
                        <i data-lucide="user" class="w-4 h-4 text-zinc-400"></i>
                    </div>
                    <div class="space-y-1">
                        <div class="text-sm font-medium text-white">User</div>
                        <div class="text-zinc-300 leading-relaxed">
                            Please replace the JWT implementation in <code>src/auth.rs</code> with PASETO v4 local
                            tokens. Ensure we keep the same claims structure.
                        </div>
                    </div>
                </div>

                <!-- Message: Agent Thought -->
                <div class="flex gap-4 max-w-4xl mx-auto">
                    <div
                        class="w-8 h-8 rounded-full bg-accent/10 border border-accent/20 flex items-center justify-center shrink-0">
                        <i data-lucide="brain-circuit" class="w-4 h-4 text-accent"></i>
                    </div>
                    <div class="space-y-2 w-full">
                        <div class="text-sm font-medium text-accent">Near Orbit Agent</div>

                        <!-- Thought Process -->
                        <div class="text-sm text-zinc-500 italic border-l-2 border-zinc-800 pl-3 py-1">
                            I need to first inspect the current dependencies to see if `paseto` crate is available, then
                            locate the JWT struct definitions.
                        </div>

                        <!-- Terminal Block -->
                        <div class="mt-2 rounded-lg border border-border bg-terminal overflow-hidden font-mono text-sm">
                            <div
                                class="px-3 py-1.5 bg-white/5 border-b border-white/5 flex items-center justify-between">
                                <span class="text-xs text-zinc-500">Terminal</span>
                                <span class="text-xs text-zinc-600">~/projects/rust-backend</span>
                            </div>
                            <div class="p-3 space-y-1 text-zinc-300 overflow-x-auto">
                                <div class="flex gap-2">
                                    <span class="text-accent">➜</span>
                                    <span>cat Cargo.toml</span>
                                </div>
                                <div class="text-zinc-500">...</div>
                                <div class="text-zinc-400">
                                    [dependencies]<br>
                                    actix-web = "4.0"<br>
                                    jsonwebtoken = "8.1"<br>
                                    serde = { version = "1.0", features = ["derive"] }
                                </div>
                            </div>
                        </div>

                        <!-- Agent Text -->
                        <div class="text-zinc-300 leading-relaxed pt-1">
                            The `paseto` crate isn't listed in your dependencies yet. I'll add it now and then start
                            drafting the new token struct.
                        </div>
                    </div>
                </div>

                <!-- Message: Agent Action (Live) -->
                <div class="flex gap-4 max-w-4xl mx-auto">
                    <div
                        class="w-8 h-8 rounded-full bg-accent/10 border border-accent/20 flex items-center justify-center shrink-0">
                        <i data-lucide="terminal-square" class="w-4 h-4 text-accent"></i>
                    </div>
                    <div class="space-y-2 w-full">
                        <div class="text-sm font-medium text-accent">Near Orbit Agent</div>
                        <div
                            class="mt-2 rounded-lg border border-border bg-terminal overflow-hidden font-mono text-sm shadow-lg shadow-accent/5">
                            <div
                                class="px-3 py-1.5 bg-white/5 border-b border-white/5 flex items-center justify-between">
                                <span class="text-xs text-zinc-500">Terminal • Active</span>
                                <div class="flex gap-1.5">
                                    <span class="w-2 h-2 rounded-full bg-red-500/50"></span>
                                    <span class="w-2 h-2 rounded-full bg-yellow-500/50"></span>
                                    <span class="w-2 h-2 rounded-full bg-green-500/50"></span>
                                </div>
                            </div>
                            <div class="p-3 space-y-1 text-zinc-300 overflow-x-auto">
                                <div class="flex gap-2">
                                    <span class="text-accent">➜</span>
                                    <span class="typing-cursor">cargo add paseto</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="h-24"></div> <!-- Spacer -->
            </div>

            <!-- Input Area -->
            <div class="p-4 border-t border-border bg-background/95 backdrop-blur absolute bottom-0 w-full z-20">
                <div class="max-w-4xl mx-auto relative">
                    <!-- Context Pills -->
                    <div class="absolute -top-10 left-0 flex gap-2">
                        <div
                            class="bg-surface border border-border text-xs text-zinc-400 px-2 py-1 rounded-md flex items-center gap-1">
                            <i data-lucide="file-code" class="w-3 h-3"></i> src/auth.rs
                        </div>
                        <div
                            class="bg-surface border border-border text-xs text-zinc-400 px-2 py-1 rounded-md flex items-center gap-1">
                            <i data-lucide="file-code" class="w-3 h-3"></i> Cargo.toml
                        </div>
                    </div>

                    <div
                        class="relative bg-surface border border-border rounded-xl shadow-lg focus-within:ring-1 focus-within:ring-accent/50 transition-all">
                        <textarea placeholder="Reply to agent or give new command..."
                            class="w-full bg-transparent text-white placeholder-zinc-600 px-4 py-3 pr-12 rounded-xl focus:outline-none resize-none h-12 max-h-32"></textarea>
                        <button
                            class="absolute right-2 bottom-2 p-1.5 bg-accent text-zinc-900 rounded-lg hover:bg-teal-300 transition-colors">
                            <i data-lucide="arrow-up" class="w-5 h-5"></i>
                        </button>
                    </div>
                    <div class="text-center mt-2">
                        <button class="text-xs text-red-400 hover:text-red-300 flex items-center gap-1 mx-auto">
                            <i data-lucide="octagon" class="w-3 h-3"></i> Stop Agent
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- ============================================
             VIEW 3: SETTINGS
        ============================================= -->
        <div id="view-settings" class="view-section flex-col flex-1 h-full bg-background overflow-y-auto p-6">
            <div class="max-w-3xl mx-auto w-full space-y-8">

                <div>
                    <h3 class="text-xl font-medium text-white mb-2">Integrations</h3>
                    <p class="text-sm text-zinc-500 mb-6">Connect your git providers to allow agents to clone, push, and
                        create PRs.</p>

                    <div class="space-y-4">
                        <!-- GitHub -->
                        <div
                            class="p-4 bg-surface border border-border rounded-xl flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between">
                            <div class="flex items-center gap-4">
                                <div class="w-10 h-10 rounded-full bg-zinc-800 flex items-center justify-center">
                                    <i data-lucide="github" class="w-5 h-5 text-white"></i>
                                </div>
                                <div>
                                    <div class="text-sm font-medium text-white">GitHub</div>
                                    <div class="text-xs text-green-400 flex items-center gap-1">
                                        <i data-lucide="check" class="w-3 h-3"></i> Connected as @ixian-dev
                                    </div>
                                </div>
                            </div>
                            <button
                                class="px-3 py-1.5 text-xs border border-zinc-700 text-zinc-400 rounded-lg hover:bg-zinc-800 hover:text-white transition-colors">
                                Re-authenticate
                            </button>
                        </div>

                        <!-- GitLab -->
                        <div
                            class="p-4 bg-surface border border-border rounded-xl flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between">
                            <div class="flex items-center gap-4">
                                <div class="w-10 h-10 rounded-full bg-zinc-800 flex items-center justify-center">
                                    <i data-lucide="gitlab" class="w-5 h-5 text-orange-500"></i>
                                </div>
                                <div>
                                    <div class="text-sm font-medium text-white">GitLab</div>
                                    <div class="text-xs text-zinc-500">Not connected</div>
                                </div>
                            </div>
                            <button
                                class="px-3 py-1.5 text-xs bg-surfaceHighlight text-white rounded-lg hover:bg-zinc-700 transition-colors">
                                Connect
                            </button>
                        </div>

                        <!-- Gitea (Expanded State) -->
                        <div class="p-4 bg-surface border border-border rounded-xl">
                            <div
                                class="flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between mb-4">
                                <div class="flex items-center gap-4">
                                    <div class="w-10 h-10 rounded-full bg-zinc-800 flex items-center justify-center">
                                        <i data-lucide="git-branch" class="w-5 h-5 text-green-500"></i>
                                    </div>
                                    <div>
                                        <div class="text-sm font-medium text-white">Gitea / Forgejo</div>
                                        <div class="text-xs text-zinc-500">Self-hosted instance</div>
                                    </div>
                                </div>
                                <div
                                    class="px-2 py-0.5 rounded bg-zinc-800 text-[10px] text-zinc-400 border border-zinc-700">
                                    CONFIGURING</div>
                            </div>

                            <!-- Inputs -->
                            <div class="space-y-3 pl-0 sm:pl-14">
                                <div>
                                    <label class="block text-xs text-zinc-500 mb-1">Instance URL</label>
                                    <input type="text" value="https://git.home.arpa"
                                        class="w-full bg-background border border-border rounded-lg px-3 py-2 text-sm text-white focus:border-accent focus:outline-none">
                                </div>
                                <div>
                                    <label class="block text-xs text-zinc-500 mb-1">Personal Access Token</label>
                                    <input type="password" value="****************"
                                        class="w-full bg-background border border-border rounded-lg px-3 py-2 text-sm text-white focus:border-accent focus:outline-none">
                                </div>
                                <div class="flex justify-end pt-2">
                                    <button
                                        class="px-4 py-2 bg-white text-black text-sm font-medium rounded-lg hover:bg-zinc-200">Save
                                        & Connect</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div>
                    <h3 class="text-xl font-medium text-white mb-2">Agent Behavior</h3>
                    <div class="p-4 bg-surface border border-border rounded-xl space-y-4">
                        <div class="flex items-center justify-between">
                            <div>
                                <div class="text-sm font-medium text-white">Auto-Commit</div>
                                <div class="text-xs text-zinc-500">Allow agent to commit changes without approval</div>
                            </div>
                            <button
                                class="w-10 h-5 rounded-full bg-zinc-700 relative transition-colors hover:bg-zinc-600">
                                <div class="absolute left-1 top-1 w-3 h-3 bg-white rounded-full"></div>
                            </button>
                        </div>
                        <div class="flex items-center justify-between">
                            <div>
                                <div class="text-sm font-medium text-white">Budget Limit</div>
                                <div class="text-xs text-zinc-500">Max API spend per session</div>
                            </div>
                            <div class="text-sm text-white font-mono bg-zinc-800 px-2 py-1 rounded">$5.00</div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </main>

    <script>
        lucide.createIcons();

        function switchView(viewName) {
            // Update Navigation State
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('bg-surfaceHighlight', 'text-accent');
                btn.classList.add('text-zinc-500');
                if (btn.id === `nav-${viewName}`) {
                    btn.classList.add('bg-surfaceHighlight', 'text-accent');
                    btn.classList.remove('text-zinc-500');
                }
            });

            // Handle Dashboard vs Settings buttons specifically
            if (viewName === 'dashboard' || viewName === 'chat') {
                const dashBtn = document.getElementById('nav-dashboard');
                dashBtn.classList.add('bg-surfaceHighlight', 'text-accent');
                dashBtn.classList.remove('text-zinc-500');

                document.getElementById('nav-settings').classList.remove('bg-surfaceHighlight', 'text-accent');
            }

            // Update Views
            document.querySelectorAll('.view-section').forEach(el => el.classList.remove('active'));
            document.getElementById(`view-${viewName}`).classList.add('active');

            // Update Title
            const titleMap = {
                'dashboard': 'Active Missions',
                'chat': 'Mission Control',
                'settings': 'Configuration'
            };
            document.getElementById('page-title').innerText = titleMap[viewName];
        }
    </script>
</body>

</html>